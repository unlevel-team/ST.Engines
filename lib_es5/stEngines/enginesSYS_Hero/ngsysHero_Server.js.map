{"version":3,"sources":["stEngines/enginesSYS_Hero/ngsysHero_Server.js"],"names":[],"mappings":"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","file":"stEngines/enginesSYS_Hero/ngsysHero_Server.js","sourcesContent":["\"use strict\";\r\n\r\n/*\r\n SomeThings Engines System library\r\n \r\n version Hero\r\n for Server\r\n\r\n*/\r\n\r\nlet Sensor = require('../Sensor.js');\r\nlet SensorEngine = require('../SensorEngine.js');\r\n\r\nlet NGSystem_Hero_Lib = require('./enginesSYS_Hero.js');\r\nlet NGSystem_Hero_CONSTANTS = NGSystem_Hero_Lib.NGSystem_Hero_CONSTANTS;\r\nlet NGSystem_Hero = NGSystem_Hero_Lib.NGSystem_Hero;\r\n\r\nlet SensorsManager_CONSTANTS = require('../services/SensorsManager.js').CONSTANTS;\r\nlet SensorsManager = require('../services/SensorsManager.js').SensorsManager;\r\n\r\n\r\n/**\r\n * SnsEngineRef\r\n * \r\n * Sensor Engine\r\n * for role Server\r\n */\r\nclass SnsEngineRef extends SensorEngine {\r\n\t\r\n\tconstructor(config) {\r\n\t\t\r\n\t\tsuper(config);\r\n\t}\r\n\t\r\n\tinitialize() {\r\n\t\t// Overrides parent method...\r\n\t}\r\n\t\r\n\t\r\n}\r\n\r\n\r\n/**\r\n * SensorRef\r\n * \r\n * Sensor\r\n * for role Server\r\n */\r\nclass SensorRef extends Sensor {\r\n\t\r\n\tconstructor(config) {\r\n\t\t\r\n\t\tsuper(config);\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tinitialize() {\r\n\t\t\r\n\t\tlet sensor = this;\r\n\t\t\r\n\t\t// initialize sensor engine\r\n\t\tsensor.sensorEngine = new SnsEngineRef( sensor.config.sensorEngine );\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Start sensor\r\n\t */\r\n\tstart() {\r\n\r\n\t\tlet stSensor = this;\r\n\r\n\t\treturn new Promise(function(resolve, reject) {\r\n\r\n\t\t\tlet request = {\r\n\t\t\t\t\"sensorID\" : stSensor.config.sensorID,\r\n\t\t\t\t\"result\" : null\r\n\r\n\t\t\t};\r\n\r\n\t\t\t// Emit message StartSensor\r\n\t\t\tstSensor.config._controlSocket.emit(SensorsManager_CONSTANTS.Messages.StartSensor , request);\r\n\r\n\t\t\tresolve(request);\r\n\r\n\t\t});\r\n\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Stop sensor\r\n\t */\r\n\tstop() {\r\n\r\n\t\tlet stSensor = this;\r\n\r\n\t\treturn new Promise(function(resolve, reject) {\r\n\r\n\t\t\tlet request = {\r\n\t\t\t\t\"sensorID\" : stSensor.config.sensorID,\r\n\t\t\t\t\"result\" : null\r\n\r\n\t\t\t};\r\n\r\n\t\t\t// Emit message StopSensor\r\n\t\t\tstSensor.config._controlSocket.emit(SensorsManager_CONSTANTS.Messages.StopSensor , request);\r\n\t\t\tresolve(request);\r\n\t\t});\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Set sensor options\r\n\t */\r\n\tsetOptions(options){\r\n\t\t\r\n\t\tlet stSensor = this;\r\n\t\tlet socket = stSensor.socket;\r\n\t\t\r\n\t\tconsole.log('<*> ST SensorRef.setOptions');\t// TODO REMOVE DEBUG LOG\r\n\t\tconsole.log(options);\t// TODO REMOVE DEBUG LOG\r\n\r\n\t\t// Emit message setSensorOptions\r\n\t\tsocket.emit(SensorsManager_CONSTANTS.Messages.setSensorOptions,\r\n\t\t\t\t{\"sensorID\" : stSensor.config.sensorID, \"options\" : options});\r\n\r\n\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n}\r\n\r\n\r\n/**\r\n * NGSYS_Hero_Server_SensorsMNG\r\n * \r\n * Sensors manager\r\n * for role Server\r\n * \r\n * SomeThings Engines System library\r\n * version Hero\r\n */\r\nclass NGSYS_Hero_Server_SensorsMNG extends SensorsManager {\r\n\t\r\n\t\r\n\tconstructor() {\r\n\t\t\r\n\t\tsuper();\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Returns Sensor searched by sysID\r\n\t */\r\n\tgetSensorBy_sysID(sensorID) {\r\n\r\n\t\tlet smngr = this;\r\n\r\n\t\tlet sensor = null;\r\n\t\tlet _i = 0;\r\n\r\n\r\n\t\t_i = smngr.sensorList.map(function(x) {return x.config._sysID; }).indexOf(sensorID);\r\n\t\tif (_i !== -1) {\r\n\t\t\tsensor = smngr.sensorList[_i];\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\t\"stSensor\": sensor,\r\n\t\t\t\"position\": _i\r\n\t\t};\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Returns Sensors searched by nodeID\r\n\t */\r\n\tgetSensorsByNode(nodeID) {\r\n\r\n\t\tlet smngr = this;\r\n\r\n\t\tlet sensors = smngr.sensorList.filter(function(sensor, _i, _sensors) {\r\n\r\n\t\t\tif (sensor.config._refSTNodeID === nodeID) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\r\n\t\t});\r\n\r\n\t\treturn {\r\n\t\t\t\"numSensors\": sensors.length,\r\n\t\t\t\"sensors\": sensors\r\n\t\t};\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Add sensor\r\n\t * \r\n\t * @sensor Sensor object\r\n\t */\r\n\taddSensor(sensor) {\r\n\t\t\r\n\t\tsuper.addSensor(sensor);\r\n\t\r\n\t\tlet smng = this;\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t\r\n}\r\n\r\n\r\n/**\r\n * NGSYS_Hero_Server\r\n */\r\nclass NGSYS_Hero_Server extends NGSystem_Hero {\r\n\t\r\n\tconstructor(config) {\r\n\t\t\r\n\t\tsuper(config);\r\n\t}\r\n\t\r\n\t\r\n\tinitialize() {\r\n\t\t\r\n\t\tsuper.initialize();\r\n\t\t\r\n\t\tlet ngSYS = this;\r\n\t\tlet _config = ngSYS.config;\r\n\t\t\r\n//\t\tcomSYS._service = new COMSys_Morse_Srv_Node(comSYS);\r\n\t}\r\n\t\r\n\t\r\n\t\r\n}\r\n\r\n\r\n\r\nlet _Lib = {\r\n\t\t\"NGSYS_Hero_Server\" : NGSYS_Hero_Server\r\n};\r\n\r\n\r\nmodule.exports = _Lib;\r\n"],"sourceRoot":"C:\\Users\\Felipe\\Documents\\Work\\SomeThings\\dev\\NLVL_STEngines\\es6"}